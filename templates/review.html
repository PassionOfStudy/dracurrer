<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="stylesheet"
      href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
      integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"
      crossorigin="anonymous"
    />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
      integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
      integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
      crossorigin="anonymous"
    ></script>
    <script src="https://cdn.jsdelivr.net/npm/bs-custom-file-input/dist/bs-custom-file-input.js"></script>
    <title>Document</title>
    <style>
      @import url("https://fonts.googleapis.com/css2?family=Creepster&display=swap");
      body {
        margin: auto;
        background: linear-gradient(rgb(29, 0, 29), rgb(99, 48, 1));
        background-repeat: no-repeat;
        background-size: cover;
      }

      .t-box {
        display: inline-block;
        font-size: 35px;
        margin-bottom: 20px;
        font-weight: bold;
        color: white;
      }

      .container-box {
        width: 1000px;
        margin: auto;
        padding: 0px 50px 50px 50px;
      }

      .rig-box {
        margin-left: 30px;
      }

      .dt-box {
        position: relative;
        font-size: 12px;
        padding-bottom: 30px;
        border-bottom: 1px solid orange;
        color: white;
      }

      .sum-box {
        margin-bottom: 10px;
        color: white;
      }

      .bo-box {
        display: flex;
        border-bottom: 1px solid orange;
        border-top: 1px solid orange;
        padding-bottom: 30px;
        padding-top: 30px;
      }

      .custom-file {
        margin-top: 30px;
        margin-bottom: 16px;
      }

      .but-box {
        display: flex;
        justify-content: space-between;
      }

      #star {
        height: 40px;
      }

      #card-box {
        margin-top: 30px;
      }

      select option[value=""][disabled] {
        display: none;
      }

      .logo-box {
        width: auto;
        height: 100px;
        font-family: "Creepster", cursive;
        font-size: 85px;
        color: white;
        text-align: center;
        margin-bottom: 30px;
      }

      .cont-box {
        display: flex;
        background-color: white;
        margin: auto;
        border-radius: 10px;
        padding: 20px;
        margin-bottom: 20px;
      }

      .rg-box {
        width: 430px;
        padding-top: 20px;
        padding-left: 30px;
      }
      .asd-box {
        display: flex;
        justify-content: space-between;
      }

      div > span {
        color: red;
      }
      .rg-box {
        width: 400px;
      }
      .lk-box {
        padding-left: 50px;
        width: 100px;
      }
    </style>
    <script>
      $(document).ready(function () {
        bsCustomFileInput.init();
        listing();
      });

      function listing() {
        $.ajax({
          type: "GET",
          url: "/review",
          data: {},
          success: function (response) {
            let reviews = response["all_review"];
            for (let i = 0; i < reviews.length; i++) {
              let titlea = reviews[i]["title"];
              let contentsa = reviews[i]["contents"];
              let stara = reviews[i]["star"];
              let filea = reviews[i]["file"];
              let timea = reviews[i]["time"];

              let temp_html = `<div class="cont-box">
                                            <div class="lf-box">
                                                <img src="../static/${filea}" width="280" height="190">
                                            </div>
                                            <div class="asd-box">
                                                <div class="rg-box">
                                                    <h2>${titlea}</h2>
                                                    <p>${contentsa}</p>
                                                </div>
                                                 <div class="lk-box">
                                                    ${timea}&nbsp;&nbsp;😍&nbsp;${stara}
                                                 </div>
                                            </div>
                                          </div>`;
              $("#card-box").append(temp_html);
            }
          },
        });
      }

      function posting() {
        let title = $("#title").val();
        let contents = $("#contents").val();
        let star = $("#star").val();

        let file = $("#file")[0].files[0];
        let form_data = new FormData();

        form_data.append("file_give", file);
        form_data.append("title_give", title);
        form_data.append("contents_give", contents);
        form_data.append("star_give", star);

        $.ajax({
          type: "POST",
          url: "/review",
          data: form_data,
          cache: false,
          contentType: false,
          processData: false,
          success: function (response) {
            alert(response["msg"]);
            window.location.reload();
          },
        });
      }
    </script>
  </head>
  <body>
    <div class="logo-box">Dracurr<span>e</span>r</div>
    <div class="container-box">
      <div class="bo-box">
        <div class="pos-box">
          <img
            src="https://search.pstatic.net/common?type=o&size=174x242&quality=100&direct=true&src=https%3A%2F%2Fcsearch-phinf.pstatic.net%2F20220216_300%2F1644976619033bgfuh_JPEG%2Fb294418d868f91202dc47953aa117cac.jpg"
            width="400"
            height="600"
          />
        </div>

        <div class="rig-box">
          <div class="sum-box">
            <span class="t-box">크레이지 러브</span> <br />
            살인을 예고 받은 개차반 일타 강사와 시한부를 선고 받은 슈퍼을 비서가
            그리는 달콤 살벌 대환장 크레이지 로맨스 드라마
          </div>
          <div class="dt-box">
            <div>감독 : 김정현 | 작가 : 김보겸</div>
            <div>
              개요 : KBS2TV, 대한민국, 2022년 | 장르 : #월화드라마, #로맨스,
              #청춘
            </div>
          </div>
          <div class="custom-file">
            <input type="file" class="custom-file-input" id="file" />
            <label class="custom-file-label" for="file"
              >마음에 드는 장면을 찍어서 올려주세요!</label
            >
          </div>
          <form action="#">
            <div class="form-group">
              <input
                type="text"
                id="title"
                class="form-control"
                placeholder="선택하신 사진의 제목을 붙여주세요!"
                style="color: gray"
                required
              />
            </div>
            <div class="form-group">
              <textarea
                class="form-control"
                id="contents"
                rows="7"
                placeholder="어느 점이 인상 깊으셨나요?"
                required
              ></textarea>
            </div>
            <div class="but-box">
              <div>
                <select id="star" name="star" style="color: gray" required>
                  <option value="" disabled selected>
                    해당 드라마의 별점을 매겨주세요!
                  </option>
                  <option value="1">😍</option>
                  <option value="2">😍😍</option>
                  <option value="3">😍😍😍</option>
                  <option value="4">😍😍😍😍</option>
                  <option value="5">😍😍😍😍😍</option>
                </select>
              </div>
              <div>
                <input type="reset" class="btn btn-danger" value="다시 쓰기" />
              </div>
              <div>
                <input
                  type="button"
                  onclick="posting()"
                  class="btn btn-primary"
                  value="저장하기"
                />
              </div>
            </div>
          </form>
        </div>
      </div>
      <div class="bd-box" id="card-box"></div>
    </div>
  </body>
</html>
